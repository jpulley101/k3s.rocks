"use strict";(self.webpackChunkk_3_s=self.webpackChunkk_3_s||[]).push([[31],{1936:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>s,toc:()=>i});var a=n(5893),r=n(1151);const l={sidebar_position:3,sidebar_label:"External Load Balancer"},o=void 0,s={id:"External-load-balancer",title:"External-load-balancer",description:"External load balancer",source:"@site/docs/External-load-balancer.md",sourceDirName:".",slug:"/External-load-balancer",permalink:"/External-load-balancer",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,sidebar_label:"External Load Balancer"},sidebar:"tutorialSidebar",previous:{title:"Install Setup",permalink:"/install-setup"},next:{title:"First Deploy",permalink:"/First-deploy"}},c={},i=[{value:"External load balancer",id:"external-load-balancer",level:2},{value:"Get wildcard certificate",id:"get-wildcard-certificate",level:2}];function d(e){const t={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",...(0,r.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h2,{id:"external-load-balancer",children:"External load balancer"}),"\n",(0,a.jsx)(t.p,{children:"In case you do not wish to expose nodes to internet directly, prefer to perfrom tls termination outside the cluster, or both, you can use a external load balancer to expose your services."}),"\n",(0,a.jsx)(t.p,{children:"You will point your a-records to this load balancer, and it will forward traffic to your cluster. Place the nodes and the load balancer in a shared private network, and expose only the load balancer to the public internet."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502     Private  network       \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502  Kubernetes Cluster  \u2502  \u2502\n\u2502  \u2502                      \u2502  \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502  \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  \u2502  \u2502 Node \u25c4\u2500\u2500\u2500\u25ba Node \u25c4\u2500\u253c\u2500\u2500\u253c\u2500\u2500\u2500\u25ba Client \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502  \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502      Private  network      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502  Kubernetes Cluster  \u2502  \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502  \u2502\n\u2502  \u2502  \u2502 Node \u25c4\u2500\u2500\u2500\u25ba Node \u2502 \u2502  \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u25b2\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u25b2\u2500\u2500\u2500\u2518 \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502     \u250c\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2510      \u2502\n\u2502     \u2502               \u2502      \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502     \u2502 Load balancer \u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u25ba Client \u2502\n\u2502     \u2502               \u2502      \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u2502     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,a.jsx)(t.h2,{id:"get-wildcard-certificate",children:"Get wildcard certificate"}),"\n",(0,a.jsxs)(t.p,{children:["Its popular to set up a load balancer ",(0,a.jsx)(t.a,{href:"https://certbot.eff.org/",children:"cert-bot"})," and a reverse proxy like ",(0,a.jsx)(t.a,{href:"https://www.nginx.com/",children:"nginx"})," or ",(0,a.jsx)(t.a,{href:"https://www.haproxy.org/",children:"haproxy"})," to automatically generate and renew certificates. You could also include health checks in the load balancer, so it would not route traffic to any unhealthy node."]}),"\n",(0,a.jsx)(t.p,{children:"Todo: Add example set up for a VPS with HAPROXY"}),"\n",(0,a.jsxs)(t.p,{children:["If you prefer you can also use a load balancer as a service. One example of this is ",(0,a.jsx)(t.a,{href:"https://www.hetzner.com/cloud/load-balancer",children:"Hetzner"}),". If you use them to host your domains as well you can set up ssl termination and certificate renewal automatically, but if you dont, you can also paste the certificates manually. You can buy a certificate, or you could generate one with letsencrypt, like this:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:'sudo docker run -it --rm --name certbot \\\n-v "/etc/letsencrypt:/etc/letsencrypt" \\\n-v "/var/lib/letsencrypt:/var/lib/letsencrypt" \\\ncertbot/certbot certonly \\\n--manual --preferred-challenges dns\n'})}),"\n",(0,a.jsx)(t.p,{children:"Follow the steps, add the dns settings as prompted, and use the generated certificates with the load balancer. You should use the fullchain.pem as a certificate and the private.pem as private key."})]})}function u(e={}){const{wrapper:t}={...(0,r.a)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},1151:(e,t,n)=>{n.d(t,{Z:()=>s,a:()=>o});var a=n(7294);const r={},l=a.createContext(r);function o(e){const t=a.useContext(l);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),a.createElement(l.Provider,{value:t},e.children)}}}]);