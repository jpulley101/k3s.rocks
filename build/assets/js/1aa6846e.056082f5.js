"use strict";(self.webpackChunkk_3_s=self.webpackChunkk_3_s||[]).push([[923],{4208:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>i,contentTitle:()=>l,default:()=>d,frontMatter:()=>r,metadata:()=>a,toc:()=>h});var s=o(5893),t=o(1151);const r={sidebar_position:9,sidebar_label:"Persistant storage with localstorage and longhorn"},l=void 0,a={id:"Persistent-Storage-Longhorn",title:"Persistent-Storage-Longhorn",description:"Persistant storage with localstorage and longhorn",source:"@site/docs/Persistent-Storage-Longhorn.md",sourceDirName:".",slug:"/Persistent-Storage-Longhorn",permalink:"/Persistent-Storage-Longhorn",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:9,frontMatter:{sidebar_position:9,sidebar_label:"Persistant storage with localstorage and longhorn"},sidebar:"tutorialSidebar",previous:{title:"Auto Healing",permalink:"/Auto-healing"},next:{title:"Private-registry",permalink:"/Private-registry"}},i={},h=[{value:"Persistant storage with localstorage and longhorn",id:"persistant-storage-with-localstorage-and-longhorn",level:2},{value:"Local storage",id:"local-storage",level:2},{value:"Local storage PVC",id:"local-storage-pvc",level:3},{value:"Ghost with persistant local storage",id:"ghost-with-persistant-local-storage",level:3},{value:"Distributed storage (Longhorn)",id:"distributed-storage-longhorn",level:2},{value:"Setting up Longhorn",id:"setting-up-longhorn",level:3},{value:"Longhorn PVC",id:"longhorn-pvc",level:3},{value:"Ghost with Longhorn distributed storage",id:"ghost-with-longhorn-distributed-storage",level:3},{value:"Longhorn UI",id:"longhorn-ui",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.a)(),...e.components},{Details:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"persistant-storage-with-localstorage-and-longhorn",children:"Persistant storage with localstorage and longhorn"}),"\n",(0,s.jsxs)(n.p,{children:["See ",(0,s.jsx)(n.a,{href:"https://rancher.com/docs/k3s/latest/en/storage/",children:"k3s storage docs"})," for more documentation."]}),"\n",(0,s.jsxs)(n.p,{children:["Below we will show two options. ",(0,s.jsx)(n.strong,{children:"Local storage"})," and ",(0,s.jsx)(n.strong,{children:"distributed storage"}),". That just means using the local storage on the node where it is running. On a single machine this is of course not a problem, but it can cause problems if you have a permanent failure of a node in a cluster, where you of course will suffer data loss. On a distributed storage on the other hand, you can make sure that the data is replicated on multiple nodes, and in that case a single node failure would be no problem."]}),"\n",(0,s.jsx)(n.h2,{id:"local-storage",children:"Local storage"}),"\n",(0,s.jsx)(n.h3,{id:"local-storage-pvc",children:"Local storage PVC"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cat pvc-ghost-localstorage.yaml | envsubst | kubectl apply -f -\n"})}),"\n",(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:"pvc-ghost-localstorage.yaml"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'--8<-- "./manifests/pvc-ghost-localstorage.yaml"\n'})})]}),"\n",(0,s.jsx)(n.h3,{id:"ghost-with-persistant-local-storage",children:"Ghost with persistant local storage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cat ghost-localstorage.yaml | envsubst | kubectl apply -f -\n"})}),"\n",(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:"ghost-localstorage.yaml"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'--8<-- "./manifests/ghost-localstorage.yaml"\n'})})]}),"\n",(0,s.jsx)(n.h2,{id:"distributed-storage-longhorn",children:"Distributed storage (Longhorn)"}),"\n",(0,s.jsx)(n.h3,{id:"setting-up-longhorn",children:"Setting up Longhorn"}),"\n",(0,s.jsxs)(n.p,{children:["Apply the ",(0,s.jsx)(n.code,{children:"longhorn.yaml"})," to install Longhorn"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f https://raw.githubusercontent.com/longhorn/longhorn/v1.4.0/deploy/longhorn.yaml\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Longhorn will be installed in the namespace ",(0,s.jsx)(n.code,{children:"longhorn-system"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"longhorn-pvc",children:"Longhorn PVC"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cat pvc-ghost-longhorn.yaml | envsubst | kubectl apply -f -\n"})}),"\n",(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:"pvc-ghost-longhorn.yaml"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'--8<-- "./manifests/pvc-ghost-longhorn.yaml"\n'})})]}),"\n",(0,s.jsx)(n.h3,{id:"ghost-with-longhorn-distributed-storage",children:"Ghost with Longhorn distributed storage"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"first delete ghost"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cat ghost-localstorage.yaml | envsubst | kubectl delete -f -\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"And then recreate it with longhorn"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cat ghost-longhorn.yaml | envsubst | kubectl apply -f -\n"})}),"\n",(0,s.jsx)(n.h2,{id:"longhorn-ui",children:"Longhorn UI"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cat longhorn-ui-ingress.yaml | envsubst | kubectl apply -f -\n"})}),"\n",(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:"longhorn-ui-ingress.yaml"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'--8<-- "./manifests/longhorn-ui-ingress.yaml"\n'})})]}),"\n",(0,s.jsxs)(n.p,{children:["Your longhorn UI should now be accessible at ",(0,s.jsx)("a",{href:"https://longhorn.dog.example.com",target:"_blank",children:(0,s.jsx)(n.a,{href:"https://longhorn.dog.example.com",children:"https://longhorn.dog.example.com"})}),"\n",(0,s.jsx)(n.img,{alt:"Longhorn UI",src:o(3655).Z+"",width:"1200",height:"1068"})]})]})}function d(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},3655:(e,n,o)=>{o.d(n,{Z:()=>s});const s=o.p+"assets/images/longhorn-ui-5fc145d63d1e3204d4b19301f28cbef8.webp"},1151:(e,n,o)=>{o.d(n,{Z:()=>a,a:()=>l});var s=o(7294);const t={},r=s.createContext(t);function l(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);